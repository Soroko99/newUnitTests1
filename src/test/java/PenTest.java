import java.io.*;
import java.lang.reflect.Field;
import java.util.Locale;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;
import static org.testng.Assert.*;
import static org.testng.AssertJUnit.assertNotNull;

/**
 * Unit test for simple App.
 */

public class PenTest {
    public static int inkValue = 1000;
    public static double sizeValue = 1.0;

    @DataProvider
    public Object[][] positiveAllParamsProvider() {
        return new Object[][]{
                {8900, 2.1, "word"}, {12000, 3.2, "wordword"}
        };
    }

    @DataProvider
    public Object[][] negativeAllParamsProvider(){
        return new Object[][]{
                {1, 2.0, ""},{2, -3.2, "word"}
        };
    }

    @DataProvider
    public Object[][] positiveTwoParamsProvider(){
        return new Object[][]{
                {1000, 1.0}, {100, 10.0}
        };
    }

    @DataProvider
    public Object[][] negativeTwoParamsProvider(){
        return new Object[][]{
                {0, 1.0}, {100, -8.2}
        };
    }

    @DataProvider
    public Object[][] positiveInkContainerValueProvider() {
        return new Object[][]{
                {100}, {5}
        };
    }

    @DataProvider
    public Object[][] negativeInkContainerValueProvider(){
        return new Object[][]{
                {-1}, {0}
        };
    }

    @DataProvider
    public Object[][] colorProvider() {
        return new Object[][]{
                {"Red"}, {"Blue"}
        };
    }

    @Test(dataProvider = "colorProvider")
    public void doSomethingElseTest(String color) throws NoSuchFieldException, IllegalAccessException {
        Pen pen = new Pen(inkValue);
        Class<? extends Pen> clazz = pen.getClass();
        Field field = clazz.getDeclaredField("color");
        field.setAccessible(true);
        field.set(pen, color);
        ByteArrayOutputStream newOutput = new ByteArrayOutputStream();
        System.setOut(new PrintStream(newOutput));
        pen.doSomethingElse();
        assertNotEquals(newOutput.toString().toLowerCase(Locale.ROOT), color.toLowerCase(Locale.ROOT));
        field.setAccessible(false);
    }

    @Test(dataProvider = "colorProvider")
    public void testGetColorPen(String color) {
        Pen pen = new Pen(inkValue, sizeValue, color);
        assertEquals(pen.getColor().toLowerCase(Locale.ROOT), color.toLowerCase(Locale.ROOT));
    }

    @Test(dataProvider = "positiveAllParamsProvider")
    public void positiveWriteTest(int containerValue, double sizeLetter, String word) {
        Pen pen = new Pen(containerValue, sizeLetter);
        assertTrue(pen.write(word).length() != 0);
    }

    @Test(dataProvider = "negativeAllParamsProvider")
    public void negativeWriteTest(int containerValue, double sizeLetter, String word) {
        Pen penWithNegativeParams = new Pen(containerValue, sizeLetter);
        assertFalse(penWithNegativeParams.write(word).length() != 0);
    }

    @Test(dataProvider = "positiveInkContainerValueProvider")
    public void positiveConstructorWithOneParamTest(int inkContainerValue) {
        Pen penWithOneParam = new Pen(inkContainerValue);
        assertNotNull(penWithOneParam);
    }

    @Test(dataProvider = "negativeInkContainerValueProvider")
    public void negativeConstructorWithOneParamTest(int inkContainerValue){
        Pen penWithOneParam = new Pen(inkContainerValue);
        assertNull(penWithOneParam);
    }

    @Test(dataProvider = "positiveTwoParamsProvider")
    public void positiveConstructorWithTwoParamsTest(int inkContainerValue, double sizeLetter) {
        Pen penWithTwoParams = new Pen(inkContainerValue, sizeLetter);
        assertNotNull(penWithTwoParams);
    }

    @Test(dataProvider = "negativeTwoParamsProvider")
    public void negativeConstructorWithTwoParamsTest(int inkContainerValue, double sizeLetter){
        Pen penWithTwoParams = new Pen(inkContainerValue, sizeLetter);
        assertNull(penWithTwoParams);
    }

    @Test(dataProvider = "positiveAllParamsProvider")
    public void positiveConstructorWithThreeParamsTest(int inkContainerValue, double sizeLetter, String color) {
        Pen penWithThreeParams = new Pen(inkContainerValue, sizeLetter, color);
        assertNotNull(penWithThreeParams);
    }

    @Test(dataProvider = "negativeAllParamsProvider")
    public void negativeConstructorWithThreeParamsTest(int inkContainerValue, double sizeLetter, String color) {
        Pen penWithThreeParams = new Pen(inkContainerValue, sizeLetter, color);
        assertNull(penWithThreeParams);
    }

    @Test(dataProvider = "positiveInkContainerValueProvider")
    public void isWorkTestPositive(int inkContainerValue) {
        Pen penWithPositiveInkValue = new Pen(inkContainerValue);
        assertTrue(penWithPositiveInkValue.isWork());
    }

    @Test(dataProvider = "negativeInkContainerValueProvider")
    public void isWorkTestNegative(int inkContainerValue) {
        Pen penWithNegativeInkValue = new Pen(inkContainerValue);
        assertFalse(penWithNegativeInkValue.isWork());
    }
}